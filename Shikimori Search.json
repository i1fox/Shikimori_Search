// ==UserScript==
// @name         Shikimori Search
// @version      1.2
// @description  Добавляет кнопки поиска на шикимори, для удобного поиска аниме сериалов.
// @author       Foksi
// @match https://shikimori.one/*
// @match http://shikimori.one/*
// @match https://shikimori.org/*
// @match http://shikimori.org/*

// ==/UserScript==

function start(){
	if (window.location.href.indexOf("https://shikimori.one/animes/") !== -1) {
		setTimeout(function () {
			if (!$(".watch-online-placeholer").length) {
				$(".c-info-right").append("<div class='watch-online-placeholer'></div>");
			}

			if ($(".watch-online-placeholer .block:last-child")) {
				$(".watch-online-placeholer .block:last-child").remove();
			}

			if (!$(".watch_link").length) {
				if (!$(".AnimeSearch").length) {
					let name = $('.head > h1').text().split("/")[1];
					$(".watch-online-placeholer").append(
					"<div class='block HDRezka'><a target=_blank href='https://rezka.ag/search/?do=search&subaction=search&q=" + name + "' class='b-link_button dark watch_link '>Найти на HDRezka</a></div>"
                    )
                    $(".watch-online-placeholer").append(
					"<div class='block AnimeGo'><a target=_blank href='https://animego.org/search/all?q=" + name + "' class='b-link_button dark watch_link '>Найти на AnimeGo</a></div>"
                    )
                    $(".watch-online-placeholer").append(
					"<div class='block AnimeVost'><a target=_blank href='https://animevost.tv/?do=search&subaction=search&story=" + name + "' class='b-link_button dark watch_link '>Найти на AnimeVost</a></div>"
                    )
                    $(".watch-online-placeholer").append(
					"<div class='block Aixart'><a target=_blank href='https://anixart.ru/search/?q=" + name + "' class='b-link_button dark watch_link '>Найти на Anixart</a></div>"
					);
				}
			}
		}, 200);
	}
}

$(document).ready(start);
$(document).on('page:load', start);
$(document).on('turbolinks:load', start);
